let allProducts=[],totalItems=0,totalPrice=0;function getCart(){return JSON.parse(localStorage.getItem("cart"))||[]}function saveCart(t){localStorage.setItem("cart",JSON.stringify(t))}function printProducts(t){const e=document.querySelector(".products-box");e&&(e.innerHTML="",t.forEach(t=>{let n=Number(t.price).toFixed(2).replace(".",",");e.innerHTML+=`\n      <li >  \n        <i class='fi-tc-plus' title='Adicionar ao Carrinho' onclick='addToCart(${t.id})'></i>\n        <figure>\n          <img src='${t.img}' alt='${t.name}' loading="lazy">\n        </figure>\n        <div>\n          <h3>${t.name}</h3>\n          <h6><em>R$</em> ${n}</h6>\n        </div>  \n      </li>\n    `}))}function addToCart(t){const e=allProducts.find(e=>e.id===t);if(!e)return;let n=getCart(),a=n.find(e=>e.id===t);a?a.quantity++:n.push({id:e.id,name:e.name,img:e.img,price:Number(e.price),quantity:1}),saveCart(n),updateCartSummary(),document.querySelector(".cart-box")&&loadCart();let r=document.querySelector(".message-info-product");r.style.display="flex",setTimeout(()=>{r.style.display="none"},1500)}function loadCart(){const t=document.querySelector(".cart-box");if(!t)return;let e=getCart();if(t.innerHTML="",0===e.length)return t.innerHTML="<p class='cart-no-products'>Adicione produtos ao seu carrinho. <a href='catalogo.html'>Conferir Produtos</a></p>",void updateCartSummary();e.forEach((e,n)=>{let a=(e.price*e.quantity).toFixed(2).replace(".",",");t.innerHTML+=`\n      <li class="cart-item">\n        <figure>\n          <img src="${e.img}" alt="${e.name}" loading="lazy">\n        </figure>\n\n        <div class='infor-product-cart'>\n          <h3>${e.name}</h3>\n          <button onclick="deleteItem(${n})">Excluir</button>\n        </div>\n\n        <div class="controls">\n          <button onclick="updateQuantity(${e.id}, 'remove')">-</button>\n          <span>${e.quantity}</span>\n          <button onclick="updateQuantity(${e.id}, 'add')">+</button>\n        </div>\n\n        <h6><em>R$ </em>${a}</h6>\n      </li>\n    `}),updateCartSummary()}function updateQuantity(t,e){let n=getCart(),a=n.find(e=>e.id===t);a&&("add"===e?a.quantity++:"remove"===e&&a.quantity>1&&a.quantity--,saveCart(n),loadCart(),updateCartSummary())}function deleteItem(t){let e=getCart();e.splice(t,1),saveCart(e),loadCart(),updateCartSummary();let n=document.querySelector(".message-delete");n.style.display="flex",setTimeout(()=>{n.style.display="none"},1500)}function calculateSummary(){let t=getCart();totalItems=t.reduce((t,e)=>t+e.quantity,0),totalPrice=t.reduce((t,e)=>t+e.quantity*e.price,0)}function updateCartSummary(){calculateSummary(),document.querySelectorAll("[data-cart-count]").forEach(t=>{t.textContent=totalItems,t.style.display=totalItems>0?"inline-flex":"none"});const t=document.querySelector(".summary-box");t&&(t.innerHTML=0!==totalItems?`\n    <p>Produtos (<span data-cart-count>${totalItems}</span>)</p>\n    <h3>Total:  <span data-cart-total>R$ ${totalPrice.toFixed(2).replace(".",",")}</span></h3>\n\n    <div class='info-delivery'>\n      <p>Entregas em √Åguas Lindas e no DF aos finais de semana.\nFrete gr√°tis a partir de R$ 19,99</p>\n      <input type="text" placeholder="Adicionar Endere√ßo" class="input-addres" />\n    </div>\n\n    <button class="btn" onclick="orderCompleted()">Finalizar Compra</button>\n  `:'\n      <p data-cart-message style="font-size:14px; opacity:.7;">\n        Aqui voc√™ encontrar√° os valores da sua compra assim que adicionar produtos.\n      </p>\n    ')}updateCartSummary(),fetch("assets/js/catalog.json").then(t=>t.json()).then(t=>{allProducts=t,document.querySelector(".products-box")&&printProducts(allProducts),document.querySelector(".cart-box")&&loadCart(),updateCartSummary()});const searchInput=document.getElementById("search");function orderCompleted(){let t=document.querySelector(".input-addres").value;if(""===t.trim()){let t=document.querySelector(".message-warning-final");return t.style.display="flex",void setTimeout(()=>{t.style.display="none"},2e3)}let e=JSON.parse(localStorage.getItem("cart"))||[];if(0===e.length)return void alert("Seu carrinho est√° vazio!");let n="*üõí NOVO PEDIDO REALIZADO*\n\n";n+="*üìç Endere√ßo de entrega:* "+t+"\n\n",n+="*Itens do pedido:*\n";let a=0;e.forEach(t=>{let e=t.price*t.quantity;a+=e,n+=`\n‚Ä¢ *${t.name}*\n`,n+=`Qtd: ${t.quantity}\n`,n+=`Pre√ßo: R$ ${t.price.toFixed(2)}\n`,n+=`Subtotal: R$ ${e.toFixed(2)}\n`}),n+="\n----------------------\n",n+=`*TOTAL GERAL: R$ ${a.toFixed(2)}*\n`,n+="----------------------\n\n",n+="*Aguardo confirma√ß√£o do pedido!*";let r=encodeURIComponent(n);window.open(`https://wa.me/556195075423?text=${r}`,"_blank"),localStorage.removeItem("cart")}searchInput&&searchInput.addEventListener("input",()=>{let t=searchInput.value.toLowerCase(),e=document.querySelector(".no-product"),n=allProducts.filter(e=>e.name.toLowerCase().includes(t));if(0===n.length)return document.querySelector(".products-box").innerHTML="",e.style.display="flex",void(e.querySelector("em").innerHTML=searchInput.value);e.style.display="none",printProducts(n)}),window.addToCart=addToCart,window.updateQuantity=updateQuantity,window.deleteItem=deleteItem,window.addEventListener("storage",t=>{"cart"===t.key&&(loadCart(),updateCartSummary())}),document.addEventListener("DOMContentLoaded",()=>{updateCartSummary(),document.querySelector(".cart-box")&&loadCart()});